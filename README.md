# mini-wp

### Link deploy
client: http://mini-wordpress.michaelryans.club
server: http://mini-wordpress-server.michaelryans.club

## User route
### User Register
```sh
POST /users/register
```
* Headers : none
* Body    : {email, name, password}
* Success : Status:201, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
{
    "_id": "5cd8456fed330c277e05658e",
    "email": "michael22@yahoo.com",
    "password": "$2a$10$67dt6omlXLuMxTkLtkgV6.1/3VcapGvYyuVEpxfYKwgJcI/GxG1l6",
    "name": "michael r",
    "__v": 0
}
```

### User Register
```sh
POST /users/login
```
* Headers : none
* Body    : {email, password}
* Success : Status:201, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
{
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1Y2Q2MjAzMGQzZWZiYjViNGVhNGM0NjciLCJlbWFpbCI6Im1pY2hhZWxAeWFob28uY29tIiwibmFtZSI6Im1pY2hhZWwgZmlyc3QiLCJpYXQiOjE1NkF-tseodeGq1t-GAhD-IfAleF2VehvwH9lPsGDSn94g",
    "message": "login success",
    "name": "michael r",
    "_id": "5cd62030d3efbb5b4ea4c467"
}
```

### Google Login
```sh
POST /users/google-login
```
* Headers : none
* Body    : none
* Success : Status:201, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
{
    "_id": "5cd8456fed330c277e05658e",
    "email": "michael22@gmail.com",
    "password": "$2a$10$67dt6omlXLuMxTkLtkgV6.1/3VcapGvYyuVEpxfYKwgJcI/GxG1l6",
    "name": "michael r",
    "image": "url........"
    "__v": 0
}
```
## Image Route
### Upload Featured image
```sh
POST /images
```
* Headers : {token}
* Body    : formData('image')
* Success : Status:201, dataTypes:{}, tags is autogenerated by Google Vision
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
{
    "tags": [
        {
            "score": 0.9953705072402954,
            "topicality": 0.9953705072402954,
            "text": "Dog"
        },
        {
            "score": 0.9890478253364563,
            "topicality": 0.9890478253364563,
            "text": "Mammal"
        },
        {
            "score": 0.9851104021072388,
            "topicality": 0.9851104021072388,
            "text": "Vertebrate"
        },
        {
            "score": 0.9838448762893677,
            "topicality": 0.9838448762893677,
            "text": "Dog breed"
        },
        {
            "score": 0.9813780188560486,
            "topicality": 0.9813780188560486,
            "text": "Canidae"
        },
        {
            "score": 0.8834781050682068,
            "topicality": 0.8834781050682068,
            "text": "Carnivore"
        },
        {
            "score": 0.8091163635253906,
            "topicality": 0.8091163635253906,
            "text": "Snout"
        },
        {
            "score": 0.7949414253234863,
            "topicality": 0.7949414253234863,
            "text": "Pembroke welsh corgi"
        },
        {
            "score": 0.7939668893814087,
            "topicality": 0.7939668893814087,
            "text": "Akita"
        },
        {
            "score": 0.7380192279815674,
            "topicality": 0.7380192279815674,
            "text": "Companion dog"
        }
    ],
    "_id": "5cd84707ed330c277e05658f",
    "image": "https://storage.googleapis.com/mini-wordpress.michaelryans.club/1557677822361corgi.jpeg",
    "user": "5cd62030d3efbb5b4ea4c467",
    "__v": 0
}
```

### Upload via Wysiwyg
```sh
POST /images/wysiwyg
```
* Headers : none
* Body    : {Object file in wysiwyg}
* Success : Status:201, dataTypes:String
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
"image_url"
```

## Article Route
### Get All Article
```sh
GET /articles
```
| Params     | Description   | 
| ------------------- |:-------------|
| tag | filter result by tag |
|title | filter result by title |
| page | pagination |
| limit | shown results per pages | 

* Headers : none
* Body    : none
* Success : Status:201, dataTypes:[{}]
* Error : Status:500 , dataTypes:{}

Example Query
```sh
GET /articles?page=2&&limit=3
```

Example Output
```javascript
[
    {
        "clap_by": [],
        "_id": "5cd714da0cd7ef3a72da6faa",
        "title": "Untitled51",
        "user": {
            "_id": "5cd62030d3efbb5b4ea4c467",
            "email": "michael@yahoo.com",
            "name": "michael"
        },
        "createdAt": "2019-05-11T18:30:50.006Z",
        "lastUpdate": "2019-05-12T00:34:45.913Z",
        "status": "published",
        "tags": [],
        "__v": 0,
        "body": "aaaaaaOn the other hand, we denounce with righteous indignation and dislike \nmen who are so beguiled and demoralized by the charms of pleasure of the\n moment, so <span>blinded by desire, that they cannot foresee</span> the pain and trouble that are bound to ensue; and equal <span>blame belongs to those who fail in their duty through weakness of will, which is the same as saying through shrinking from toil</span>\n and pain. These cases are perfectly simple and easy to distinguish. In a\n free hour, when our power of choice is untrammelled and when nothing \nprevents our being able to do what we like best, every pleasure is to be\n welcomed and every pain avoided. But in certain circumstances and owing\n to the claims of duty or the obligations of business it will frequently\n occur that pleasures have to be repudiated and annoyances accepted. The\n wise man therefore always holds in these matters to this principle of \nselection: he rejects pleasures to secure other greater pleasures, or \nelse he endures pains to avoid worse pains."
    },
    {
        "clap_by": [],
        "_id": "5cd71df5524db50c0c8609ad",
        "title": "testing 1234",
        "user": {
            "_id": "5cd62030d3efbb5b4ea4c467",
            "email": "michael@yahoo.com",
            "name": "michael test"
        },
        "createdAt": "2019-05-11T19:09:41.618Z",
        "lastUpdate": "2019-05-12T04:12:13.682Z",
        "status": "published",
        "tags": [
            {
                "_id": "5cd71e12524db50c0c8609b1",
                "text": "anjing"
            },
            {
                "_id": "5cd71e12524db50c0c8609b0",
                "text": "lucu"
            },
            {
                "_id": "5cd71e12524db50c0c8609af",
                "text": "123"
            },
            {
                "_id": "5cd79d1d3c86b43ca572af27",
                "text": "akita"
            }
        ],
        "__v": 0,
        "body": "upload gambarrrrrr <img src=\"https://storage.googleapis.com/mini-wordpress.michaelryans.club/1557601790932corgi.jpeg\">",
        "image": "https://storage.googleapis.com/mini-wordpress.michaelryans.club/1557601805410corgi.jpeg"
    },
    {
        "clap_by": [],
        "_id": "5cd71f3d524db50c0c8609b3",
        "title": "Untitled1232345123",
        "user": {
            "_id": "5cd62030d3efbb5b4ea4c467",
            "email": "michael@yahoo.com",
            "name": "michael s"
        },
        "createdAt": "2019-05-11T19:15:09.816Z",
        "lastUpdate": "2019-05-12T10:57:56.853Z",
        "status": "draft",
        "tags": [
            {
                "_id": "5cd7f8413c86b43ca572af39",
                "text": "halo"
            },
            {
                "_id": "5cd7f8413c86b43ca572af38",
                "text": "tambah tag"
            }
        ],
        "__v": 0,
        "image": "https://storage.googleapis.com/mini-wordpress.michaelryans.club/1557629977689sohot.jpeg",
        "body": "<div>addfdsd1232332321232123</div><div>asdf</div><div>123testyayayaya<br></div>",
        "subtitle": "horeyuhuu"
    }
]
```

### Find Specific Article
```sh
GET /articles/:id
```

* Headers : none
* Body    : none
* Success : Status:200, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Query
```sh
GET /articles/5cd714da0cd7ef3a72da6faa
```

Example Output
```javascript
{
    "clap_by": [],
    "_id": "5cd714da0cd7ef3a72da6faa",
    "title": "Untitled51",
    "user": {
        "_id": "5cd62030d3efbb5b4ea4c467",
        "email": "michael@yahoo.com",
        "password": "$2a$10$pPnLfI8pmOWFyjhyJiIoVe9rCGzHDW1ZCL0wBYZS8l.EYgLjwuTOy",
        "name": "michael first",
        "__v": 0
    },
    "createdAt": "2019-05-11T18:30:50.006Z",
    "lastUpdate": "2019-05-12T00:34:45.913Z",
    "status": "published",
    "tags": [],
    "__v": 0,
    "body": "On the other hand, we denounce with righteous indignation and dislike \nmen who are so beguiled and demoralized by the charms of pleasure of the\n moment, so <span>blinded by desire, that they cannot foresee</span> the pain and trouble that are bound to ensue; and equal <span>blame belongs to those who fail in their duty through weakness of will, which is the same as saying through shrinking from toil</span>\n and pain. These cases are perfectly simple and easy to distinguish. In a\n free hour, when our power of choice is untrammelled and when nothing \nprevents our being able to do what we like best, every pleasure is to be\n welcomed and every pain avoided. But in certain circumstances and owing\n to the claims of duty or the obligations of business it will frequently\n occur that pleasures have to be repudiated and annoyances accepted. The\n wise man therefore always holds in these matters to this principle of \nselection: he rejects pleasures to secure other greater pleasures, or \nelse he endures pains to avoid worse pains."
}
```
### Get All User's Article( Published & Drafts)
```sh
GET /articles/user
```

* Headers : {token}
* Body    : none
* Success : Status:200, dataTypes:[{}]
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
[
    {
        "clap_by": [],
        "_id": "5cd714da0cd7ef3a72da6faa",
        "title": "Untitled51",
        "user": {
            "_id": "5cd62030d3efbb5b4ea4c467",
            "email": "michael@yahoo.com",
            "password": "$2a$10$pPnLfI8pmOWFyjhyJiIoVe9rCGzHDW1ZCL0wBYZS8l.EYgLjwuTOy",
            "name": "michael first",
            "__v": 0
        },
        "createdAt": "2019-05-11T18:30:50.006Z",
        "lastUpdate": "2019-05-12T00:34:45.913Z",
        "status": "published",
        "tags": [],
        "__v": 0,
        "body": "On the other hand, we denounce with righteous indignation and dislike \nmen who are so beguiled and demoralized by the charms of pleasure of the\n moment, so <span>blinded by desire, that they cannot foresee</span> the pain and trouble that are bound to ensue; and equal <span>blame belongs to those who fail in their duty through weakness of will, which is the same as saying through shrinking from toil</span>\n and pain. These cases are perfectly simple and easy to distinguish. In a\n free hour, when our power of choice is untrammelled and when nothing \nprevents our being able to do what we like best, every pleasure is to be\n welcomed and every pain avoided. But in certain circumstances and owing\n to the claims of duty or the obligations of business it will frequently\n occur that pleasures have to be repudiated and annoyances accepted. The\n wise man therefore always holds in these matters to this principle of \nselection: he rejects pleasures to secure other greater pleasures, or \nelse he endures pains to avoid worse pains."
    }  
]
```

### Create New Article
```sh
POST /articles
```

* Headers : {token}
* Body    : none
* Success : Status:201, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Output
```javascript
{
    "clap_by": [],
    "_id": "5cd84c271146e62cdacc857c",
    "title": "Untitled",
    "subtitle": "Subtitle here",
    "user": "5cd62030d3efbb5b4ea4c467",
    "createdAt": "2019-05-12T16:39:03.613Z",
    "lastUpdate": "2019-05-12T16:39:03.613Z",
    "status": "draft",
    "tags": [],
    "__v": 0
}
```

### Article Claps (not implemented in client)
```sh
PATCH /articles/:article_id/claps
```
* Headers : {token}
* Body    : none
* Success : Status:201, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Query
```sh
PATCH /articles/5cd6254c63be835f3fed0422/claps
```

Example Output
```javascript
{
    "clap_by": [
        "5cd62030d3efbb5b4ea4c467" //<-- added user id
    ],
    "_id": "5cd714da0cd7ef3a72da6faa",
    "title": "Untitled51",
    "user": "5cd62030d3efbb5b4ea4c467",
    "createdAt": "2019-05-11T18:30:50.006Z",
    "lastUpdate": "2019-05-12T00:34:45.913Z",
    "status": "published",
    "tags": [],
    "__v": 0,
    "body": "aaaaaaOn the other hand, we denounce with righteous indignation and dislike \nmen who are so beguiled and demoralized by the charms of pleasure of the\n moment, so <span>blinded by desire, that they cannot foresee</span> the pain and trouble that are bound to ensue; and equal <span>blame belongs to those who fail in their duty through weakness of will, which is the same as saying through shrinking from toil</span>\n and pain. These cases are perfectly simple and easy to distinguish. In a\n free hour, when our power of choice is untrammelled and when nothing \nprevents our being able to do what we like best, every pleasure is to be\n welcomed and every pain avoided. But in certain circumstances and owing\n to the claims of duty or the obligations of business it will frequently\n occur that pleasures have to be repudiated and annoyances accepted. The\n wise man therefore always holds in these matters to this principle of \nselection: he rejects pleasures to secure other greater pleasures, or \nelse he endures pains to avoid worse pains."
}
```

### Patch Article Data
```sh
PATCH /articles/:article_id
```
* Headers : {token}
* Body    : none
* Success : Status:200, dataTypes:{}
* Error : Status:500 , dataTypes:{}

Example Query
```sh
PATCH /articles/5cd6254c63be835f3fed0422
```

Example Input
```javascript
{
    "title":"test_update_title"
}
```

Example Output
```javascript
{
    "clap_by": [],
    "_id": "5cd7bc6a3c86b43ca572af2d",
    "title": "test_update_title",
    "subtitle": "Subtitle here",
    "user": "5cd62030d3efbb5b4ea4c467",
    "createdAt": "2019-05-12T06:25:46.995Z",
    "lastUpdate": "2019-05-12T16:47:14.044Z",
    "status": "draft",
    "tags": [],
    "__v": 0,
    "body": "<div>testing halooo auto save jalaaan selama lagi ngetik harusnya ngga sih :-)test HALO</div>"
}
```

### Delete Article
```sh
DELETE /articles/:article_id
```
* Headers : {token}
* Body    : none
* Success : Status:200, dataTypes:{}
* Error : Status:500 , dataTypes:{}


Example Output
```javascript

{
    "clap_by": [],
    "_id": "5cd84e53c503c22e0b4ddced",
    "title": "Untitled",
    "subtitle": "Subtitle here",
    "user": "5cd62030d3efbb5b4ea4c467",
    "createdAt": "2019-05-12T16:48:19.604Z",
    "lastUpdate": "2019-05-12T16:48:19.604Z",
    "status": "draft",
    "tags": [],
    "__v": 0
}
```
